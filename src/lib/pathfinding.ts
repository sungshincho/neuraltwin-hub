/**
 * Customer Pathfinding System
 * 20개의 사전 정의된 고객 동선 케이스를 사용합니다.
 * 시간대에 따라 가중치를 적용하여 랜덤하게 케이스가 선택됩니다.
 * 
 * 변환 규칙: Blender (x, y) → Viewer [x, 0.5, z] where z = -y
 */

// 시간대 타입
export type TimeSlot = 'morning' | 'afternoon' | 'evening';

// 20개의 3D 경로 케이스 (이미 [x, 0.5, z] 형식)
const PATH_CASES: [number, number, number][][] = [
// Case 1 (34 포인트)
   [
    [2, 0.5, 5], [2, 0.5, 4], [3, 0.5, 4], [4, 0.5, 4], [5, 0.5, 4], [5, 0.5, 3],
    [4, 0.5, 3], [4, 0.5, 2], [3, 0.5, 2], [3, 0.5, 1], [3, 0.5, 0], [4, 0.5, 0],
    [4, 0.5, 1], [4, 0.5, 2], [4, 0.5, 3], [5, 0.5, 3], [5, 0.5, 4], [6, 0.5, 4],
    [6, 0.5, 3], [6, 0.5, 2], [6, 0.5, 1], [6, 0.5, 0], [6, 0.5, -1], [6, 0.5, -2],
    [5, 0.5, -2], [4, 0.5, -2], [3, 0.5, -2], [2, 0.5, -2], [2, 0.5, -3], [1, 0.5, -3],
    [1, 0.5, -4], [1, 0.5, -5], [2, 0.5, -5], [3, 0.5, -5], [4, 0.5, -5], [4, 0.5, -6],
    [4, 0.5, -7], [5, 0.5, -7], [5, 0.5, -6], [5, 0.5, -5], [5, 0.5, -4], [5, 0.5, -3],
    [5, 0.5, -2], [6, 0.5, -2], [6, 0.5, -3], [6, 0.5, -4], [6, 0.5, -5], [6, 0.5, -6],
    [6, 0.5, -7], [5, 0.5, -7], [5, 0.5, -6], [5, 0.5, -5], [4, 0.5, -5], [4, 0.5, -6],
    [3, 0.5, -6], [3, 0.5, -5], [2, 0.5, -5], [1, 0.5, -5], [1, 0.5, -6], [1, 0.5, -7],
    [0, 0.5, -7], [-1, 0.5, -7], [-2, 0.5, -7], [-2, 0.5, -6], [-1, 0.5, -6], [0, 0.5, -6],
    [1, 0.5, -6], [1, 0.5, -5], [1, 0.5, -4], [1, 0.5, -3], [1, 0.5, -2], [1, 0.5, -1],
    [1, 0.5, 0], [1, 0.5, 1], [1, 0.5, 2], [1, 0.5, 3], [2, 0.5, 3], [2, 0.5, 4],
    [2, 0.5, 5],
  ],

  // Case 2 (83 포인트) - requireCheckout = true
  [
    [2, 0.5, 5], [2, 0.5, 4], [3, 0.5, 4], [4, 0.5, 4], [5, 0.5, 4], [5, 0.5, 3],
    [6, 0.5, 3], [6, 0.5, 4], [5, 0.5, 4], [5, 0.5, 3], [4, 0.5, 3], [3, 0.5, 3],
    [2, 0.5, 3], [2, 0.5, 4], [2, 0.5, 5], [2, 0.5, 4], [3, 0.5, 4], [4, 0.5, 4],
    [5, 0.5, 4], [6, 0.5, 4], [6, 0.5, 3], [6, 0.5, 2], [6, 0.5, 1], [6, 0.5, 0],
    [6, 0.5, -1], [6, 0.5, -2], [5, 0.5, -2], [4, 0.5, -2], [4, 0.5, -3], [3, 0.5, -3],
    [2, 0.5, -3], [2, 0.5, -2], [1, 0.5, -2], [1, 0.5, -1], [1, 0.5, 0], [1, 0.5, 1],
    [1, 0.5, 2], [0, 0.5, 2], [-1, 0.5, 2], [-1, 0.5, 3], [0, 0.5, 3], [1, 0.5, 3],
    [2, 0.5, 3], [2, 0.5, 4], [3, 0.5, 4], [4, 0.5, 4], [5, 0.5, 4], [6, 0.5, 4],
    [6, 0.5, 3], [6, 0.5, 2], [6, 0.5, 1], [6, 0.5, 0], [6, 0.5, -1], [6, 0.5, -2],
    [5, 0.5, -2], [4, 0.5, -2], [4, 0.5, -3], [5, 0.5, -3], [6, 0.5, -3], [6, 0.5, -4],
    [5, 0.5, -4], [5, 0.5, -5], [5, 0.5, -6], [6, 0.5, -6], [6, 0.5, -7], [5, 0.5, -7],
    [4, 0.5, -7], [3, 0.5, -7], [2, 0.5, -7], [1, 0.5, -7], [1, 0.5, -6], [1, 0.5, -5],
    [1, 0.5, -4], [1, 0.5, -3], [1, 0.5, -2], [1, 0.5, -1], [1, 0.5, 0], [1, 0.5, 1],
    [1, 0.5, 2], [1, 0.5, 3], [2, 0.5, 3], [2, 0.5, 4], [2, 0.5, 5],
  ],

  // Case 3 (55 포인트) - requireCheckout = true
  [
    [2, 0.5, 5], [2, 0.5, 4], [3, 0.5, 4], [3, 0.5, 3], [2, 0.5, 3], [1, 0.5, 3],
    [1, 0.5, 4], [0, 0.5, 4], [0, 0.5, 3], [0, 0.5, 2], [1, 0.5, 2], [1, 0.5, 1],
    [1, 0.5, 0], [0, 0.5, 0], [-1, 0.5, 0], [-2, 0.5, 0], [-2, 0.5, -1], [-1, 0.5, -1],
    [0, 0.5, -1], [1, 0.5, -1], [1, 0.5, -2], [2, 0.5, -2], [3, 0.5, -2], [4, 0.5, -2],
    [5, 0.5, -2], [5, 0.5, -3], [5, 0.5, -4], [5, 0.5, -5], [4, 0.5, -5], [3, 0.5, -5],
    [3, 0.5, -6], [3, 0.5, -7], [2, 0.5, -7], [1, 0.5, -7], [1, 0.5, -6], [1, 0.5, -5],
    [2, 0.5, -5], [3, 0.5, -5], [3, 0.5, -6], [4, 0.5, -6], [3, 0.5, -6], [2, 0.5, -6],
    [1, 0.5, -6], [1, 0.5, -5], [1, 0.5, -4], [1, 0.5, -3], [1, 0.5, -2], [1, 0.5, -1],
    [1, 0.5, 0], [1, 0.5, 1], [1, 0.5, 2], [1, 0.5, 3], [2, 0.5, 3], [2, 0.5, 4],
    [2, 0.5, 5],
  ],

  // Case 4 (49 포인트) - requireCheckout = true
  [
    [2, 0.5, 5], [2, 0.5, 4], [1, 0.5, 4], [0, 0.5, 4], [0, 0.5, 3], [1, 0.5, 3],
    [1, 0.5, 2], [1, 0.5, 1], [1, 0.5, 0], [0, 0.5, 0], [-1, 0.5, 0], [-1, 0.5, -1],
    [-2, 0.5, -1], [-3, 0.5, -1], [-4, 0.5, -1], [-4, 0.5, -2], [-3, 0.5, -2], [-3, 0.5, -3],
    [-2, 0.5, -3], [-2, 0.5, -4], [-2, 0.5, -5], [-2, 0.5, -6], [-1, 0.5, -6], [0, 0.5, -6],
    [1, 0.5, -6], [1, 0.5, -5], [1, 0.5, -4], [1, 0.5, -3], [1, 0.5, -2], [2, 0.5, -2],
    [3, 0.5, -2], [4, 0.5, -2], [5, 0.5, -2], [6, 0.5, -2], [6, 0.5, -1], [6, 0.5, 0],
    [6, 0.5, 1], [6, 0.5, 2], [6, 0.5, 3], [6, 0.5, 4], [5, 0.5, 4], [4, 0.5, 4],
    [4, 0.5, 3], [5, 0.5, 3], [4, 0.5, 3], [3, 0.5, 3], [2, 0.5, 3], [2, 0.5, 4],
    [2, 0.5, 5],
  ],

  // Case 5 (63 포인트) - requireCheckout = true
  [
    [2, 0.5, 5], [2, 0.5, 4], [2, 0.5, 3], [1, 0.5, 3], [1, 0.5, 4], [0, 0.5, 4],
    [-1, 0.5, 4], [-2, 0.5, 4], [-3, 0.5, 4], [-3, 0.5, 3], [-2, 0.5, 3], [-1, 0.5, 3],
    [-1, 0.5, 2], [-2, 0.5, 2], [-3, 0.5, 2], [-4, 0.5, 2], [-5, 0.5, 2], [-5, 0.5, 3],
    [-4, 0.5, 3], [-3, 0.5, 3], [-2, 0.5, 3], [-1, 0.5, 3], [0, 0.5, 3], [1, 0.5, 3],
    [1, 0.5, 2], [1, 0.5, 1], [1, 0.5, 0], [1, 0.5, -1], [1, 0.5, -2], [1, 0.5, -3],
    [1, 0.5, -4], [1, 0.5, -5], [2, 0.5, -5], [2, 0.5, -6], [3, 0.5, -6], [4, 0.5, -6],
    [4, 0.5, -7], [3, 0.5, -7], [2, 0.5, -7], [1, 0.5, -7], [0, 0.5, -7], [-1, 0.5, -7],
    [-2, 0.5, -7], [-2, 0.5, -6], [-3, 0.5, -6], [-3, 0.5, -7], [-2, 0.5, -7], [-1, 0.5, -7],
    [0, 0.5, -7], [1, 0.5, -7], [1, 0.5, -6], [1, 0.5, -5], [1, 0.5, -4], [1, 0.5, -3],
    [1, 0.5, -2], [1, 0.5, -1], [1, 0.5, 0], [1, 0.5, 1], [1, 0.5, 2], [1, 0.5, 3],
    [2, 0.5, 3], [2, 0.5, 4], [2, 0.5, 5],
  ],

  // Case 6 (55 포인트) - requireCheckout = true
  [
    [2, 0.5, 5], [2, 0.5, 4], [2, 0.5, 3], [1, 0.5, 3], [1, 0.5, 4], [0, 0.5, 4],
    [-1, 0.5, 4], [-2, 0.5, 4], [-2, 0.5, 3], [-1, 0.5, 3], [-1, 0.5, 2], [0, 0.5, 2],
    [1, 0.5, 2], [1, 0.5, 3], [0, 0.5, 3], [0, 0.5, 4], [-1, 0.5, 4], [-2, 0.5, 4],
    [-2, 0.5, 3], [-2, 0.5, 2], [-1, 0.5, 2], [0, 0.5, 2], [1, 0.5, 2], [1, 0.5, 1],
    [1, 0.5, 0], [1, 0.5, -1], [1, 0.5, -2], [2, 0.5, -2], [2, 0.5, -3], [3, 0.5, -3],
    [3, 0.5, -2], [4, 0.5, -2], [5, 0.5, -2], [5, 0.5, -3], [4, 0.5, -3], [3, 0.5, -3],
    [2, 0.5, -3], [2, 0.5, -2], [3, 0.5, -2], [4, 0.5, -2], [5, 0.5, -2], [5, 0.5, -3],
    [4, 0.5, -3], [3, 0.5, -3], [2, 0.5, -3], [1, 0.5, -3], [1, 0.5, -2], [1, 0.5, -1],
    [1, 0.5, 0], [1, 0.5, 1], [1, 0.5, 2], [1, 0.5, 3], [2, 0.5, 3], [2, 0.5, 4],
    [2, 0.5, 5],
  ],

  // Case 7 (65 포인트) - requireCheckout = true
  [
    [2, 0.5, 5], [2, 0.5, 4], [3, 0.5, 4], [3, 0.5, 3], [3, 0.5, 2], [3, 0.5, 1],
    [4, 0.5, 1], [4, 0.5, 2], [4, 0.5, 3], [5, 0.5, 3], [5, 0.5, 4], [4, 0.5, 4],
    [3, 0.5, 4], [3, 0.5, 3], [3, 0.5, 2], [3, 0.5, 1], [3, 0.5, 0], [4, 0.5, 0],
    [4, 0.5, 1], [4, 0.5, 2], [4, 0.5, 3], [4, 0.5, 4], [5, 0.5, 4], [5, 0.5, 3],
    [6, 0.5, 3], [6, 0.5, 2], [6, 0.5, 1], [6, 0.5, 0], [6, 0.5, -1], [6, 0.5, -2],
    [5, 0.5, -2], [5, 0.5, -3], [5, 0.5, -4], [5, 0.5, -5], [6, 0.5, -5], [6, 0.5, -6],
    [5, 0.5, -6], [4, 0.5, -6], [3, 0.5, -6], [2, 0.5, -6], [2, 0.5, -7], [3, 0.5, -7],
    [4, 0.5, -7], [5, 0.5, -7], [6, 0.5, -7], [6, 0.5, -6], [6, 0.5, -5], [6, 0.5, -4],
    [5, 0.5, -4], [5, 0.5, -5], [4, 0.5, -5], [3, 0.5, -5], [2, 0.5, -5], [1, 0.5, -5],
    [1, 0.5, -4], [1, 0.5, -3], [1, 0.5, -2], [1, 0.5, -1], [1, 0.5, 0], [1, 0.5, 1],
    [1, 0.5, 2], [1, 0.5, 3], [2, 0.5, 3], [2, 0.5, 4], [2, 0.5, 5],
  ],

  // Case 8 (71 포인트) - requireCheckout = true
  [
    [2, 0.5, 5], [2, 0.5, 4], [2, 0.5, 3], [3, 0.5, 3], [4, 0.5, 3], [4, 0.5, 2],
    [3, 0.5, 2], [3, 0.5, 1], [3, 0.5, 0], [4, 0.5, 0], [4, 0.5, 1], [4, 0.5, 2],
    [4, 0.5, 3], [4, 0.5, 4], [3, 0.5, 4], [3, 0.5, 3], [3, 0.5, 2], [3, 0.5, 1],
    [3, 0.5, 0], [4, 0.5, 0], [4, 0.5, 1], [4, 0.5, 2], [4, 0.5, 3], [5, 0.5, 3],
    [5, 0.5, 4], [6, 0.5, 4], [6, 0.5, 3], [6, 0.5, 2], [6, 0.5, 1], [6, 0.5, 0],
    [6, 0.5, -1], [6, 0.5, -2], [5, 0.5, -2], [4, 0.5, -2], [3, 0.5, -2], [2, 0.5, -2],
    [1, 0.5, -2], [1, 0.5, -3], [1, 0.5, -4], [1, 0.5, -5], [1, 0.5, -6], [1, 0.5, -7],
    [2, 0.5, -7], [3, 0.5, -7], [4, 0.5, -7], [4, 0.5, -6], [3, 0.5, -6], [3, 0.5, -5],
    [2, 0.5, -5], [2, 0.5, -6], [1, 0.5, -6], [0, 0.5, -6], [0, 0.5, -7], [-1, 0.5, -7],
    [-2, 0.5, -7], [-1, 0.5, -7], [0, 0.5, -7], [1, 0.5, -7], [1, 0.5, -6], [1, 0.5, -5],
    [1, 0.5, -4], [1, 0.5, -3], [1, 0.5, -2], [1, 0.5, -1], [1, 0.5, 0], [1, 0.5, 1],
    [1, 0.5, 2], [1, 0.5, 3], [2, 0.5, 3], [2, 0.5, 4], [2, 0.5, 5],
  ],

  // Case 9 (55 포인트) - requireCheckout = true
  [
    [2, 0.5, 5], [2, 0.5, 4], [3, 0.5, 4], [3, 0.5, 3], [4, 0.5, 3], [4, 0.5, 4],
    [5, 0.5, 4], [5, 0.5, 3], [6, 0.5, 3], [6, 0.5, 2], [6, 0.5, 1], [6, 0.5, 0],
    [6, 0.5, -1], [6, 0.5, -2], [5, 0.5, -2], [4, 0.5, -2], [3, 0.5, -2], [2, 0.5, -2],
    [2, 0.5, -3], [3, 0.5, -3], [4, 0.5, -3], [5, 0.5, -3], [5, 0.5, -4], [5, 0.5, -5],
    [4, 0.5, -5], [4, 0.5, -6], [5, 0.5, -6], [6, 0.5, -6], [6, 0.5, -7], [5, 0.5, -7],
    [4, 0.5, -7], [3, 0.5, -7], [3, 0.5, -6], [3, 0.5, -5], [2, 0.5, -5], [2, 0.5, -6],
    [1, 0.5, -6], [0, 0.5, -6], [-1, 0.5, -6], [-2, 0.5, -6], [-2, 0.5, -5], [-2, 0.5, -4],
    [-2, 0.5, -3], [-2, 0.5, -2], [-2, 0.5, -1], [-1, 0.5, -1], [0, 0.5, -1], [1, 0.5, -1],
    [1, 0.5, 0], [1, 0.5, 1], [1, 0.5, 2], [1, 0.5, 3], [2, 0.5, 3], [2, 0.5, 4],
    [2, 0.5, 5],
  ],

  // Case 10 (63 포인트) - requireCheckout = true
  [
    [2, 0.5, 5], [2, 0.5, 4], [2, 0.5, 3], [1, 0.5, 3], [1, 0.5, 4], [0, 0.5, 4],
    [-1, 0.5, 4], [-1, 0.5, 3], [0, 0.5, 3], [0, 0.5, 2], [-1, 0.5, 2], [-2, 0.5, 2],
    [-2, 0.5, 3], [-2, 0.5, 4], [-3, 0.5, 4], [-4, 0.5, 4], [-3, 0.5, 4], [-2, 0.5, 4],
    [-1, 0.5, 4], [0, 0.5, 4], [1, 0.5, 4], [1, 0.5, 3], [1, 0.5, 2], [1, 0.5, 1],
    [1, 0.5, 0], [1, 0.5, -1], [1, 0.5, -2], [1, 0.5, -3], [1, 0.5, -4], [1, 0.5, -5],
    [2, 0.5, -5], [2, 0.5, -6], [2, 0.5, -7], [1, 0.5, -7], [1, 0.5, -6], [0, 0.5, -6],
    [0, 0.5, -7], [-1, 0.5, -7], [-2, 0.5, -7], [-3, 0.5, -7], [-3, 0.5, -6], [-4, 0.5, -6],
    [-5, 0.5, -6], [-5, 0.5, -7], [-4, 0.5, -7], [-3, 0.5, -7], [-2, 0.5, -7], [-1, 0.5, -7],
    [0, 0.5, -7], [1, 0.5, -7], [1, 0.5, -6], [1, 0.5, -5], [1, 0.5, -4], [1, 0.5, -3],
    [1, 0.5, -2], [1, 0.5, -1], [1, 0.5, 0], [1, 0.5, 1], [1, 0.5, 2], [1, 0.5, 3],
    [2, 0.5, 3], [2, 0.5, 4], [2, 0.5, 5],
  ],

  // Case 11 (75 포인트) - requireCheckout = true
  [
    [2, 0.5, 5], [2, 0.5, 4], [3, 0.5, 4], [3, 0.5, 3], [2, 0.5, 3], [1, 0.5, 3],
    [1, 0.5, 2], [0, 0.5, 2], [0, 0.5, 1], [0, 0.5, 0], [-1, 0.5, 0], [-1, 0.5, -1],
    [-2, 0.5, -1], [-2, 0.5, 0], [-3, 0.5, 0], [-4, 0.5, 0], [-5, 0.5, 0], [-6, 0.5, 0],
    [-6, 0.5, 1], [-6, 0.5, 2], [-5, 0.5, 2], [-5, 0.5, 3], [-6, 0.5, 3], [-6, 0.5, 4],
    [-6, 0.5, 5], [-5, 0.5, 5], [-5, 0.5, 4], [-4, 0.5, 4], [-3, 0.5, 4], [-2, 0.5, 4],
    [-1, 0.5, 4], [0, 0.5, 4], [1, 0.5, 4], [1, 0.5, 3], [1, 0.5, 2], [1, 0.5, 1],
    [1, 0.5, 0], [1, 0.5, -1], [1, 0.5, -2], [2, 0.5, -2], [2, 0.5, -3], [3, 0.5, -3],
    [3, 0.5, -2], [4, 0.5, -2], [4, 0.5, -3], [5, 0.5, -3], [5, 0.5, -4], [5, 0.5, -5],
    [4, 0.5, -5], [4, 0.5, -6], [3, 0.5, -6], [3, 0.5, -7], [2, 0.5, -7], [1, 0.5, -7],
    [0, 0.5, -7], [-1, 0.5, -7], [-1, 0.5, -6], [0, 0.5, -6], [1, 0.5, -6], [2, 0.5, -6],
    [3, 0.5, -6], [3, 0.5, -5], [2, 0.5, -5], [1, 0.5, -5], [1, 0.5, -4], [1, 0.5, -3],
    [1, 0.5, -2], [1, 0.5, -1], [1, 0.5, 0], [1, 0.5, 1], [1, 0.5, 2], [1, 0.5, 3],
    [2, 0.5, 3], [2, 0.5, 4], [2, 0.5, 5],
  ],

  // Case 12 (53 포인트) - requireCheckout = true
  [
    [2, 0.5, 5], [2, 0.5, 4], [1, 0.5, 4], [0, 0.5, 4], [0, 0.5, 3], [1, 0.5, 3],
    [2, 0.5, 3], [3, 0.5, 3], [4, 0.5, 3], [5, 0.5, 3], [5, 0.5, 4], [6, 0.5, 4],
    [6, 0.5, 3], [6, 0.5, 2], [6, 0.5, 1], [6, 0.5, 0], [6, 0.5, -1], [6, 0.5, -2],
    [6, 0.5, -3], [6, 0.5, -4], [5, 0.5, -4], [5, 0.5, -5], [4, 0.5, -5], [3, 0.5, -5],
    [2, 0.5, -5], [1, 0.5, -5], [1, 0.5, -4], [1, 0.5, -3], [1, 0.5, -2], [2, 0.5, -2],
    [3, 0.5, -2], [3, 0.5, -3], [2, 0.5, -3], [1, 0.5, -3], [1, 0.5, -4], [1, 0.5, -5],
    [2, 0.5, -5], [2, 0.5, -6], [3, 0.5, -6], [2, 0.5, -6], [1, 0.5, -6], [1, 0.5, -5],
    [1, 0.5, -4], [1, 0.5, -3], [1, 0.5, -2], [1, 0.5, -1], [1, 0.5, 0], [1, 0.5, 1],
    [1, 0.5, 2], [1, 0.5, 3], [2, 0.5, 3], [2, 0.5, 4], [2, 0.5, 5],
  ],

  // ========== 재방문자 경로 (z > -3, 계산대 도달 안 함) ==========
  
  // Case 13: 입구 오른쪽 구역만 탐색 (상단 우측)
  [
    [2, 0.5, 5], [2, 0.5, 4], [3, 0.5, 4], [4, 0.5, 4], [5, 0.5, 4], [5, 0.5, 3],
    [6, 0.5, 3], [6, 0.5, 2], [6, 0.5, 1], [6, 0.5, 0], [5, 0.5, 0], [5, 0.5, 1],
    [4, 0.5, 1], [4, 0.5, 2], [4, 0.5, 3], [3, 0.5, 3], [3, 0.5, 4], [2, 0.5, 4],
    [2, 0.5, 5],
  ],

  // Case 14: 입구 왼쪽 구역만 탐색 (상단 좌측)
  [
    [2, 0.5, 5], [2, 0.5, 4], [1, 0.5, 4], [0, 0.5, 4], [-1, 0.5, 4], [-2, 0.5, 4],
    [-2, 0.5, 3], [-3, 0.5, 3], [-4, 0.5, 3], [-5, 0.5, 3], [-5, 0.5, 2], [-4, 0.5, 2],
    [-3, 0.5, 2], [-2, 0.5, 2], [-1, 0.5, 2], [0, 0.5, 2], [0, 0.5, 3], [1, 0.5, 3],
    [1, 0.5, 4], [2, 0.5, 4], [2, 0.5, 5],
  ],

  // Case 15: 중앙 구역 탐색 (좌우 이동)
  [
    [2, 0.5, 5], [2, 0.5, 4], [2, 0.5, 3], [3, 0.5, 3], [4, 0.5, 3], [4, 0.5, 2],
    [3, 0.5, 2], [2, 0.5, 2], [1, 0.5, 2], [0, 0.5, 2], [-1, 0.5, 2], [-1, 0.5, 1],
    [0, 0.5, 1], [1, 0.5, 1], [2, 0.5, 1], [3, 0.5, 1], [3, 0.5, 0], [2, 0.5, 0],
    [1, 0.5, 0], [1, 0.5, 1], [1, 0.5, 2], [1, 0.5, 3], [2, 0.5, 3], [2, 0.5, 4],
    [2, 0.5, 5],
  ],

  // Case 16: 매장 좌측 깊숙이 탐색 (좌하단, z > -3)
  [
    [2, 0.5, 5], [2, 0.5, 4], [1, 0.5, 4], [0, 0.5, 4], [-1, 0.5, 4], [-2, 0.5, 4],
    [-3, 0.5, 4], [-4, 0.5, 4], [-5, 0.5, 4], [-6, 0.5, 4], [-6, 0.5, 3], [-6, 0.5, 2],
    [-6, 0.5, 1], [-6, 0.5, 0], [-5, 0.5, 0], [-4, 0.5, 0], [-3, 0.5, 0], [-2, 0.5, 0],
    [-1, 0.5, 0], [0, 0.5, 0], [1, 0.5, 0], [1, 0.5, 1], [1, 0.5, 2], [1, 0.5, 3],
    [2, 0.5, 3], [2, 0.5, 4], [2, 0.5, 5],
  ],

  // Case 17: 매장 우측 깊숙이 탐색 (우하단, z > -3)
  [
    [2, 0.5, 5], [2, 0.5, 4], [3, 0.5, 4], [4, 0.5, 4], [5, 0.5, 4], [6, 0.5, 4],
    [6, 0.5, 3], [6, 0.5, 2], [6, 0.5, 1], [6, 0.5, 0], [6, 0.5, -1], [6, 0.5, -2],
    [5, 0.5, -2], [4, 0.5, -2], [3, 0.5, -2], [2, 0.5, -2], [1, 0.5, -2], [1, 0.5, -1],
    [1, 0.5, 0], [1, 0.5, 1], [1, 0.5, 2], [1, 0.5, 3], [2, 0.5, 3], [2, 0.5, 4],
    [2, 0.5, 5],
  ],

  // Case 18: 매장 전체 상단 U자형 탐색
  [
    [2, 0.5, 5], [2, 0.5, 4], [3, 0.5, 4], [4, 0.5, 4], [5, 0.5, 4], [6, 0.5, 4],
    [6, 0.5, 3], [6, 0.5, 2], [5, 0.5, 2], [4, 0.5, 2], [3, 0.5, 2], [2, 0.5, 2],
    [1, 0.5, 2], [0, 0.5, 2], [-1, 0.5, 2], [-2, 0.5, 2], [-3, 0.5, 2], [-4, 0.5, 2],
    [-5, 0.5, 2], [-6, 0.5, 2], [-6, 0.5, 3], [-6, 0.5, 4], [-5, 0.5, 4], [-4, 0.5, 4],
    [-3, 0.5, 4], [-2, 0.5, 4], [-1, 0.5, 4], [0, 0.5, 4], [1, 0.5, 4], [2, 0.5, 4],
    [2, 0.5, 5],
  ],

  // Case 19: 입구 근처만 짧게 탐색 (빠른 재방문)
  [
    [2, 0.5, 5], [2, 0.5, 4], [3, 0.5, 4], [3, 0.5, 3], [2, 0.5, 3], [1, 0.5, 3],
    [1, 0.5, 4], [0, 0.5, 4], [0, 0.5, 3], [1, 0.5, 3], [2, 0.5, 3], [2, 0.5, 4],
    [2, 0.5, 5],
  ],

  // Case 20: 중앙 + 좌측 탐색 (중간 거리)
  [
    [2, 0.5, 5], [2, 0.5, 4], [2, 0.5, 3], [1, 0.5, 3], [0, 0.5, 3], [-1, 0.5, 3],
    [-2, 0.5, 3], [-2, 0.5, 2], [-2, 0.5, 1], [-2, 0.5, 0], [-1, 0.5, 0], [0, 0.5, 0],
    [1, 0.5, 0], [1, 0.5, 1], [1, 0.5, 2], [2, 0.5, 2], [3, 0.5, 2], [3, 0.5, 3],
    [2, 0.5, 3], [2, 0.5, 4], [2, 0.5, 5],
  ],

  // Case 21: 중앙 + 우측 탐색 (중간 거리)
  [
    [2, 0.5, 5], [2, 0.5, 4], [2, 0.5, 3], [3, 0.5, 3], [4, 0.5, 3], [5, 0.5, 3],
    [5, 0.5, 2], [5, 0.5, 1], [5, 0.5, 0], [4, 0.5, 0], [3, 0.5, 0], [2, 0.5, 0],
    [1, 0.5, 0], [1, 0.5, 1], [1, 0.5, 2], [1, 0.5, 3], [2, 0.5, 3], [2, 0.5, 4],
    [2, 0.5, 5],
  ],

  // Case 22: 좌측 하단 구역 탐색 (z = -2까지)
  [
    [2, 0.5, 5], [2, 0.5, 4], [1, 0.5, 4], [0, 0.5, 4], [-1, 0.5, 4], [-1, 0.5, 3],
    [-1, 0.5, 2], [-1, 0.5, 1], [-1, 0.5, 0], [-1, 0.5, -1], [-1, 0.5, -2], [-2, 0.5, -2],
    [-3, 0.5, -2], [-4, 0.5, -2], [-4, 0.5, -1], [-4, 0.5, 0], [-3, 0.5, 0], [-2, 0.5, 0],
    [-1, 0.5, 0], [0, 0.5, 0], [1, 0.5, 0], [1, 0.5, 1], [1, 0.5, 2], [1, 0.5, 3],
    [2, 0.5, 3], [2, 0.5, 4], [2, 0.5, 5],
  ],

  // Case 23: 매장 전체 중앙 횡단 (z = 0 라인)
  [
    [2, 0.5, 5], [2, 0.5, 4], [2, 0.5, 3], [2, 0.5, 2], [2, 0.5, 1], [2, 0.5, 0],
    [3, 0.5, 0], [4, 0.5, 0], [5, 0.5, 0], [6, 0.5, 0], [6, 0.5, 1], [5, 0.5, 1],
    [4, 0.5, 1], [3, 0.5, 1], [2, 0.5, 1], [1, 0.5, 1], [0, 0.5, 1], [-1, 0.5, 1],
    [-2, 0.5, 1], [-3, 0.5, 1], [-4, 0.5, 1], [-4, 0.5, 2], [-3, 0.5, 2], [-2, 0.5, 2],
    [-1, 0.5, 2], [0, 0.5, 2], [1, 0.5, 2], [1, 0.5, 3], [2, 0.5, 3], [2, 0.5, 4],
    [2, 0.5, 5],
  ],

  // Case 24: 우측 벽면 따라 탐색
  [
    [2, 0.5, 5], [2, 0.5, 4], [3, 0.5, 4], [4, 0.5, 4], [5, 0.5, 4], [6, 0.5, 4],
    [6, 0.5, 3], [6, 0.5, 2], [6, 0.5, 1], [6, 0.5, 0], [6, 0.5, -1], [5, 0.5, -1],
    [4, 0.5, -1], [4, 0.5, 0], [4, 0.5, 1], [4, 0.5, 2], [3, 0.5, 2], [2, 0.5, 2],
    [1, 0.5, 2], [1, 0.5, 3], [2, 0.5, 3], [2, 0.5, 4], [2, 0.5, 5],
  ],

  // Case 25: 좌측 벽면 따라 탐색
  [
    [2, 0.5, 5], [2, 0.5, 4], [1, 0.5, 4], [0, 0.5, 4], [-1, 0.5, 4], [-2, 0.5, 4],
    [-3, 0.5, 4], [-4, 0.5, 4], [-5, 0.5, 4], [-6, 0.5, 4], [-6, 0.5, 3], [-6, 0.5, 2],
    [-6, 0.5, 1], [-6, 0.5, 0], [-6, 0.5, -1], [-5, 0.5, -1], [-4, 0.5, -1], [-4, 0.5, 0],
    [-3, 0.5, 0], [-2, 0.5, 0], [-1, 0.5, 0], [0, 0.5, 0], [1, 0.5, 0], [1, 0.5, 1],
    [1, 0.5, 2], [1, 0.5, 3], [2, 0.5, 3], [2, 0.5, 4], [2, 0.5, 5],
  ],

  // Case 26: 지그재그 탐색 (상단 영역)
  [
    [2, 0.5, 5], [2, 0.5, 4], [3, 0.5, 4], [4, 0.5, 4], [4, 0.5, 3], [3, 0.5, 3],
    [2, 0.5, 3], [1, 0.5, 3], [0, 0.5, 3], [0, 0.5, 4], [-1, 0.5, 4], [-2, 0.5, 4],
    [-2, 0.5, 3], [-3, 0.5, 3], [-3, 0.5, 2], [-2, 0.5, 2], [-1, 0.5, 2], [0, 0.5, 2],
    [1, 0.5, 2], [2, 0.5, 2], [3, 0.5, 2], [3, 0.5, 3], [2, 0.5, 3], [2, 0.5, 4],
    [2, 0.5, 5],
  ],
];

const TIME_SLOT_WEIGHTS: Record<TimeSlot, number[]> = {
  // 오전: 재방문(13~26번, 계산대 미도달) 위주, 신규/체크아웃 비율 낮게
  morning: [
    //  Case  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, (신규 - 계산대 도달)
        1,   1,  1,  1,  1,  1,  1,  1,  1,  1,  1,  1,
    // Case 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26 (재방문 - 다양한 구역)
        3,   3,  3,  2,  2,  2,  3,  2,  2,  2,  2,  2,  2,  3,
  ],

  // 오후: 신규/재방문 균형 (다양한 구역 탐색)
  afternoon: [
    //  Case  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, (신규 - 계산대 도달)
        2,   2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,
    // Case 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26 (재방문 - 다양한 구역)
        2,   2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,  2,
  ],

  // 저녁: 신규 비율 높음 (퇴근 후 본격 쇼핑)
  evening: [
    //  Case  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, (신규 - 계산대 도달)
        3,   3,  3,  3,  3,  3,  3,  3,  3,  3,  3,  3,
    // Case 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26 (재방문 - 다양한 구역)
        2,   2,  2,  1,  1,  1,  2,  1,  1,  1,  1,  1,  1,  2,
  ],
};

// Entry point (입구 좌표)
export const ENTRY_POINT: [number, number, number] = [2, 0.5, 5];

// Store bounds
export const STORE_BOUNDS = {
  xMin: -7.0,
  xMax: 7.0,
  zMin: -7.0,
  zMax: 5.5,
};

/**
 * 시간 범위에서 시간대 추출
 */
export function getTimeSlotFromRange(timeRange: string): TimeSlot {
  const hour = parseInt(timeRange.split(':')[0].split('-')[0]) || parseInt(timeRange.split('-')[0]) || 12;
  
  if (hour < 12) return 'morning';
  if (hour < 18) return 'afternoon';
  return 'evening';
}

/**
 * 가중치 기반 랜덤 선택
 */
function weightedRandomSelect(weights: number[]): number {
  const totalWeight = weights.reduce((sum, w) => sum + w, 0);
  let random = Math.random() * totalWeight;
  
  for (let i = 0; i < weights.length; i++) {
    random -= weights[i];
    if (random <= 0) return i;
  }
  
  return weights.length - 1;
}

/**
 * 대각선 이동을 수평/수직 이동으로 변환
 */
function convertToOrthogonalPath(path: [number, number, number][]): [number, number, number][] {
  if (path.length < 2) return path;
  
  const orthogonalPath: [number, number, number][] = [path[0]];
  
  for (let i = 1; i < path.length; i++) {
    const prev = path[i - 1];
    const curr = path[i];
    
    const dx = Math.abs(curr[0] - prev[0]);
    const dz = Math.abs(curr[2] - prev[2]);
    
    // x와 z가 모두 변하면 (대각선 이동) 중간 웨이포인트 삽입
    if (dx > 0.01 && dz > 0.01) {
      // 수평 이동 먼저 (x축), 그 다음 수직 이동 (z축)
      const waypoint: [number, number, number] = [curr[0], prev[1], prev[2]];
      orthogonalPath.push(waypoint);
    }
    
    orthogonalPath.push(curr);
  }
  
  return orthogonalPath;
}

/**
 * 시간대 기반 랜덤 고객 경로 생성
 */
export function generateRandomCustomerPath(timeRange: string): [number, number, number][] {
  const timeSlot = getTimeSlotFromRange(timeRange);
  const weights = TIME_SLOT_WEIGHTS[timeSlot];
  const caseIndex = weightedRandomSelect(weights);
  
  // 대각선 이동을 수평/수직으로 변환하여 반환
  return convertToOrthogonalPath([...PATH_CASES[caseIndex]]);
}

/**
 * 특정 케이스 경로 가져오기 (1-15)
 */
export function getPathByCase(caseNumber: number): [number, number, number][] {
  const index = Math.max(0, Math.min(caseNumber - 1, PATH_CASES.length - 1));
  return [...PATH_CASES[index]];
}

/**
 * 경로가 계산대에 도달하는지 확인
 * 계산대 위치: z <= -3 영역
 */
export function pathReachesCheckout(path: [number, number, number][]): boolean {
  return path.some(point => point[2] <= -3);
}

/**
 * 총 케이스 개수 반환
 */
export function getTotalCases(): number {
  return PATH_CASES.length;
}
